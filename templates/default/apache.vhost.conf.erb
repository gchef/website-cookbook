<VirtualHost *:80>
  ServerName <%= @website.name %>
<% if @website.server_name -%>
  ServerAlias <%= @website.server_name %>
<% end -%>
  DocumentRoot <%= @website.home %>/public

  <Directory />
    Options -Indexes
  </Directory>

  LogLevel info
  ErrorLog <%= @website.home %>/log/error.log
  CustomLog <%= @website.home %>/log/access.log common

#   # DON'T FORGET TO ENABLE proxy_http module
#   ProxyRequests On
#   ProxyPreserveHost Off
#   ProxyPass /blog http://blog.domain.net/ connectiontimeout=5 timeout=30
#   ProxyPassReverse /blog http://blog.domain.net/
#   <Proxy http://blog.domain.net/>
#     AddDefaultCharset off
#     Order allow,deny
#     Allow from all
#   </Proxy>

  RewriteEngine on
  <% @website.apache.fetch(:rewrites) { {} }.each do |rewrite| -%>
    RewriteRule <%= rewrite.fetch(:pattern) %> <%= rewrite.fetch(:substitution) %> [<%= rewrite.fetch(:flags) { "R=301,L" } %>]
  <% end -%>

  # Disabled?
  RewriteCond %{DOCUMENT_ROOT}/disabled.html -f
  RewriteCond %{SCRIPT_FILENAME} !disabled.html
  RewriteRule ^.*$ /disabled.html [L]
</VirtualHost>
